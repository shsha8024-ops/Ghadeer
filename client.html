<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„</title>
  <style>
    body { font-family:'Cairo',sans-serif; background:#eef2f7; margin:0; padding:20px; color:#333; }
    header { text-align:center; }
    h1 { color:#cc3300; }
    a.back, a.back-bottom {
      display:inline-block; margin:10px 0; background:#003366; color:#fff; padding:8px 15px; border-radius:8px; text-decoration:none; font-weight:bold;
    }
    a.back:hover, a.back-bottom:hover { background:#005599; }
    form { display:grid; grid-template-columns:repeat(4,1fr) auto; gap:10px; margin:20px auto; max-width:900px; background:#fff; padding:20px; border-radius:12px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    input,button { padding:10px; border-radius:8px; border:1px solid #ccc; font-size:14px; }
    button { background:#cc3300; color:#fff; border:none; cursor:pointer; font-weight:bold; transition:.3s; }
    button:hover { background:#ff5500; }
    table { width:100%; border-collapse:collapse; margin-top:20px; background:#fff; border-radius:12px; overflow:hidden; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    th,td { padding:12px; border-bottom:1px solid #eee; text-align:center; }
    th { background:#f5f5f5; color:#444; }
    tr:hover { background:#fafafa; }
    .action-btn { padding:5px 10px; border:none; border-radius:6px; cursor:pointer; font-size:13px; margin:2px; }
    .edit { background:#ffc107; color:#333; }
    .edit:hover { background:#e0a800; }
    .delete { background:#dc3545; color:#fff; }
    .delete:hover { background:#bd2130; }
    tfoot td { font-weight:bold; background:#fafafa; }
    .back-container { text-align:center; margin-top:20px; }
  </style>
</head>
<body>
<header>
  <h1 id="title">Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„</h1>
  <a href="accounts.html" class="back">â¬…ï¸ Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</a>
</header>
<form id="invoiceForm">
  <input type="date" id="date" required>
  <input type="text" id="driver" placeholder="ğŸšš Ø§Ø³Ù… Ø§Ù„Ø³Ø§Ø¦Ù‚" required>
  <input type="text" id="cargo" placeholder="ğŸ“¦ Ø§Ù„Ø­Ù…ÙˆÙ„Ø©" required>
  <input type="number" id="price" placeholder="ğŸ’° Ø§Ù„Ø³Ø¹Ø±" required>
  <button type="submit">â• Ø¥Ø¶Ø§ÙØ© ÙØ§ØªÙˆØ±Ø©</button>
</form>
<table>
  <thead><tr><th>ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>ğŸšš Ø§Ù„Ø³Ø§Ø¦Ù‚</th><th>ğŸ“¦ Ø§Ù„Ø­Ù…ÙˆÙ„Ø©</th><th>ğŸ’° Ø§Ù„Ø³Ø¹Ø±</th><th>âš™ï¸ Ø®ÙŠØ§Ø±Ø§Øª</th></tr></thead>
  <tbody id="rows"></tbody>
  <tfoot><tr><td colspan="3">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</td><td id="total"></td><td></td></tr></tfoot>
</table>
<div class="back-container">
  <a href="accounts.html" class="back-bottom">ğŸ”™ Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</a>
</div>
<script>
let params=new URLSearchParams(location.search);
let client=params.get("name");
document.getElementById("title").textContent="Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„: "+client;
let accounts=JSON.parse(localStorage.getItem("accounts"))||{};
if(!accounts[client]) accounts[client]=[];
let list=accounts[client];

function render(){
  const tbody=document.getElementById("rows");
  tbody.innerHTML="";
  let total=0;
  list.forEach((e,i)=>{
    let tr=document.createElement("tr");
    tr.innerHTML=`<td>${e.date}</td><td>${e.driver}</td><td>${e.cargo}</td><td>${Number(e.price).toLocaleString("en-US")}</td>
    <td>
      <button class="action-btn edit" onclick="editInvoice(${i})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
      <button class="action-btn delete" onclick="deleteInvoice(${i})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
    </td>`;
    tbody.appendChild(tr);
    total+=Number(e.price);
  });
  document.getElementById("total").textContent=total.toLocaleString("en-US");
}

document.getElementById("invoiceForm").addEventListener("submit", e=>{
  e.preventDefault();
  const entry={
    date:document.getElementById("date").value,
    driver:document.getElementById("driver").value,
    cargo:document.getElementById("cargo").value,
    price:document.getElementById("price").value
  };
  if(editIndex!==null){
    list[editIndex]=entry;
    editIndex=null;
  } else {
    list.push(entry);
  }
  accounts[client]=list;
  localStorage.setItem("accounts",JSON.stringify(accounts));
  render();
  e.target.reset();
  document.querySelector("#invoiceForm button").textContent="â• Ø¥Ø¶Ø§ÙØ© ÙØ§ØªÙˆØ±Ø©";
});

let editIndex=null;
function editInvoice(i){
  const e=list[i];
  document.getElementById("date").value=e.date;
  document.getElementById("driver").value=e.driver;
  document.getElementById("cargo").value=e.cargo;
  document.getElementById("price").value=e.price;
  editIndex=i;
  document.querySelector("#invoiceForm button").textContent="ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„";
}
function deleteInvoice(i){
  if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©ØŸ")){
    list.splice(i,1);
    accounts[client]=list;
    localStorage.setItem("accounts",JSON.stringify(accounts));
    render();
  }
}
render();
</script>
</body>
</html>