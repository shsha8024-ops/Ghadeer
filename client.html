<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ghadeer Logistics | Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„</title>
  <link rel="stylesheet" href="assets/css/theme.css">
</head>
<body>
  <header class="app-header">
    <div class="brand">
      <div class="brand-mark">GL</div>
      <h1>Ghadeer Logistics</h1>
    </div>
    <nav class="nav-links">
      <a class="nav-link" href="Home.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      <a class="nav-link" href="about.html">Ø¹Ù† Ø§Ù„Ø´Ø±ÙƒØ©</a>
      <a class="nav-link" href="dashboard.html">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>
      <a class="nav-link active" href="accounts.html">Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</a>
      <a class="nav-link" href="track.html">ØªØªØ¨Ø¹ Ø§Ù„Ø´Ø­Ù†Ø§Øª</a>
      <a class="nav-link" href="Reportal.html">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</a>
      <a class="nav-link" href="contact.html">Ø§ØªØµÙ„ Ø¨Ù†Ø§</a>
      <a class="nav-link" href="index.html">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>
    </nav>
  </header>

  <main class="page-shell">
    <section class="glass-card hero-card">
      <h2 class="page-title" id="title">Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„</h2>
      <p class="lead">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙÙˆØ§ØªÙŠØ± ÙˆØ§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø¯Ø¯. ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙˆØ±Ù‹Ø§ Ø¨Ø¹Ø¯ ÙƒÙ„ ØªØ¹Ø¯ÙŠÙ„.</p>
      <div class="chip-row">
        <span class="chip">ğŸ“‘ ÙÙˆØ§ØªÙŠØ±: <span id="invoiceCount">0</span></span>
        <span class="chip">ğŸ’° Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø³ØªØ­Ù‚: <span id="totalValue">0</span> Ø¯.Ø¹</span>
      </div>
      <div class="actions-row">
        <a class="button ghost" href="accounts.html">â¬…ï¸ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</a>
      </div>
    </section>

    <section class="glass-card">
      <div class="section-heading">
        <div>
          <h2>Ø¥Ø¶Ø§ÙØ© ÙØ§ØªÙˆØ±Ø©</h2>
          <p>Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø£Ùˆ Ø¹Ø¯Ù‘Ù„ ÙØ§ØªÙˆØ±Ø© Ø­Ø§Ù„ÙŠØ©.</p>
        </div>
      </div>
      <form id="invoiceForm" class="form-grid inline">
        <div>
          <label for="date">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
          <input type="date" id="date" required>
        </div>
        <div>
          <label for="driver">Ø§Ø³Ù… Ø§Ù„Ø³Ø§Ø¦Ù‚</label>
          <input type="text" id="driver" placeholder="Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯ Ø±Ø´ÙŠØ¯" required>
        </div>
        <div>
          <label for="cargo">Ø§Ù„Ø­Ù…ÙˆÙ„Ø©</label>
          <input type="text" id="cargo" placeholder="Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø©" required>
        </div>
        <div>
          <label for="price">Ø§Ù„Ø³Ø¹Ø±</label>
          <input type="number" id="price" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø§Ù„Ø¯ÙŠÙ†Ø§Ø±" required>
        </div>
        <button class="button primary" type="submit" id="submitBtn">â• Ø¥Ø¶Ø§ÙØ© ÙØ§ØªÙˆØ±Ø©</button>
      </form>
    </section>

    <section class="glass-card table-card">
      <div class="table-header">
        <div class="section-heading">
          <div>
            <h2>Ø³Ø¬Ù„ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</h2>
            <p>ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø£Ùˆ Ø­Ø°Ù Ø£ÙŠ ÙØ§ØªÙˆØ±Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©.</p>
          </div>
        </div>
      </div>
      <div class="table-scroll">
        <table class="data-table">
          <thead>
            <tr>
              <th>ğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
              <th>ğŸšš Ø§Ù„Ø³Ø§Ø¦Ù‚</th>
              <th>ğŸ“¦ Ø§Ù„Ø­Ù…ÙˆÙ„Ø©</th>
              <th>ğŸ’° Ø§Ù„Ø³Ø¹Ø±</th>
              <th>âš™ï¸ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª</th>
            </tr>
          </thead>
          <tbody id="rows"></tbody>
          <tfoot>
            <tr>
              <td colspan="5">
                <div class="chip">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨: <span id="totalFooter">0</span> Ø¯.Ø¹</div>
              </td>
            </tr>
          </tfoot>
        </table>
      </div>
    </section>

    <p class="footer-note">ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ Ø§Ù„Ù…Ø­Ù„ÙŠ. ØªØ£ÙƒØ¯ Ù…Ù† ØªØµØ¯ÙŠØ±Ù‡Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©.</p>
  </main>

  <script>
    const params = new URLSearchParams(location.search);
    const client = params.get('name') || 'Ø¹Ù…ÙŠÙ„ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
    const title = document.getElementById('title');
    title.textContent = 'Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„: ' + client;

    let accounts = JSON.parse(localStorage.getItem('accounts')) || {};
    if (!accounts[client]) {
      accounts[client] = [];
    }
    let list = accounts[client];
    let editIndex = null;

    function render() {
      const tbody = document.getElementById('rows');
      const invoiceCount = document.getElementById('invoiceCount');
      const totalBadge = document.getElementById('totalValue');
      const totalFooter = document.getElementById('totalFooter');

      tbody.innerHTML = '';
      let total = 0;

      list.forEach((entry, index) => {
        const amount = Number(entry.price) || 0;
        total += amount;
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${entry.date || '-'}</td>
          <td>${entry.driver || '-'}</td>
          <td>${entry.cargo || '-'}</td>
          <td>${amount.toLocaleString('en-US')}</td>
          <td>
            <div class="action-buttons">
              <button class="action-button edit" onclick="editInvoice(${index})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
              <button class="action-button delete" onclick="deleteInvoice(${index})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
            </div>
          </td>`;
        tbody.appendChild(tr);
      });

      invoiceCount.textContent = list.length;
      totalBadge.textContent = total.toLocaleString('en-US');
      totalFooter.textContent = total.toLocaleString('en-US');
    }

    document.getElementById('invoiceForm').addEventListener('submit', (event) => {
      event.preventDefault();
      const entry = {
        date: document.getElementById('date').value,
        driver: document.getElementById('driver').value,
        cargo: document.getElementById('cargo').value,
        price: document.getElementById('price').value
      };

      if (editIndex !== null) {
        list[editIndex] = entry;
        editIndex = null;
        document.getElementById('submitBtn').textContent = 'â• Ø¥Ø¶Ø§ÙØ© ÙØ§ØªÙˆØ±Ø©';
      } else {
        list.push(entry);
      }

      accounts[client] = list;
      localStorage.setItem('accounts', JSON.stringify(accounts));
      render();
      event.target.reset();
    });

    function editInvoice(index) {
      const entry = list[index];
      document.getElementById('date').value = entry.date;
      document.getElementById('driver').value = entry.driver;
      document.getElementById('cargo').value = entry.cargo;
      document.getElementById('price').value = entry.price;
      document.getElementById('submitBtn').textContent = 'ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„';
      editIndex = index;
    }

    function deleteInvoice(index) {
      if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©ØŸ')) {
        list.splice(index, 1);
        accounts[client] = list;
        localStorage.setItem('accounts', JSON.stringify(accounts));
        render();
      }
    }

    render();
  </script>
</body>
</html>
